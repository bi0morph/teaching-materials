<!doctype html>
<html>
<head>
<title>События и Анимация</title>
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="css/normalize.css" />
<link rel="stylesheet" type="text/css" href="css/presentation.css" />
<link rel="stylesheet" type="text/css" href="css/prettify.css" />
<link  href="http://fonts.googleapis.com/css?family=Ubuntu:300,300italic,regular,italic,500,500italic,bold,bolditalic" rel="stylesheet" type="text/css">
<script src="js/jquery.js" type="text/javascript"></script>
<script src="js/fathom.js"></script>
<script src="js/prettify.js"></script>
<script>
$(document).ready(function(){
    $('pre').addClass('prettyprint').attr('tabIndex', 0);
    prettyPrint();
    
    var fathom = $('#presentation').fathom({
        onActivateSlide: function() {
            var $slide = $(this);
            $slide.find('pre:first').focus();
        }
    });
});
</script>
</head>
<body>

<div id="presentation">
  
   <div id="presentation-counter"></div>
      
   <div id="slides">
    <div class="slide section"> 
     <header><h2>События и Анимация</header>
    </div> 
    
    
    <div class="slide normal"> 
     <header><h2>Когда нам нужны события?</h2></header>
     <section class="content"> 
     <ul>
 <li>Валидация форм и обработка
 <li><a href="http://www.alvarotrigo.com/fullPage/">Интерактивные слайд-шоу</a>
 <li><a href="http://www.queness.com/post/9283/10-addictive-games-you-wouldnt-believe-theyre-made-with-javascript">Игры</a>
 <li><a href="http://docs.google.com">Single-page webapps</a>
 <li>...все что требует действий от пользователя.
</ul>

     </section>
    </div>
    
    <div class="slide normal"> 
     <header><h2>Добавление обработчика события</h2></header>
     <section class="content"> 
     <p>В IE 9+ (и всех других браузеров):</p>
<pre>
domNode.addEventListener(eventType, eventListener, useCapture);
</pre>

<pre class="prettyprint">
&lt;button id=&quot;counter&quot;&gt;0&lt;/button&gt;
  
&lt;script&gt;
var counterButton = document.getElementById('counter');
var onButtonClick = function() {
    counterButton.innerHTML = parseInt(counterButton.innerHTML) + 1;
};
counterButton.addEventListener('click', onButtonClick, false);
&lt;/script&gt;
</pre>

<pre class="prettyprint" style="display:none;">
На предыдущем занятии мы изучили Document Object Model, и как она позволяет манипулировать элементами страницы.
Большую часть времени нам необходимо выполнять эти манипуляции в результате каких либо действий пользователя на странице.
Именно тут и приходят нам на помощь `события`.
`Событие` это тип объкета который создается когда пользователь взаимодейстувет с веб-страницей.
События Events are связаны с элементом с котороым пользователь взаимодействовал. Например, когда пользователь кликнул на ссылку, событие `click` было создано для этого элемента.
Что бы вызвать наш блок кода для какого-то события нам нужно подписатся на это событие - создать обработчик события('event listener').
</pre>
     </section>
    </div>
    
   
    
    
    
    <div class="slide normal"> 
     <header><h2>Типы событий</h2></header>
     <section class="content"> 
     <p>Броузер вызывает много типов <a href="https://developer.mozilla.org/en-US/docs/Web/Events">событий</a>. Мини список:</p>
<ul>
 <li>события мыши (<a href="https://developer.mozilla.org/en/DOM/MouseEvent">MouseEvent</a>):  <code>mousedown</code>, <code>mouseup</code>
    , <code>click</code>, <code>dblclick</code>, <code>mousemove</code>, <code>mouseover</code>, <code>mousewheel</code>
    , <code>mouseout</code>, <code>contextmenu</code>
 <li>touch события (<a href="https://developer.mozilla.org/en/DOM/TouchEvent">TouchEvent</a>): <code>touchstart</code>, <code>touchmove</code>, <code>touchend</code>, <code>touchcancel</code>
 <li>события клавиатуры (<a href="https://developer.mozilla.org/en/DOM/KeyboardEvent">KeyboardEvent</a>): <code>keydown</code>, <code>keypress</code>, <code>keyup</code>
 <li>события элементов формы: <code>focus</code>, <code>blur</code>, <code>change</code>, <code>submit</code>
<li>события окна браузера(window): <code>scroll</code>, <code>resize</code>, <code>hashchange</code>, <code>load</code>, <code>unload</code>
</ul>
     </section>
    </div>
    
    
    <div class="slide normal"> 
     <header><h2>Обработка событий полей форм</h2></header>
     <section class="content"> 
     <p>Распрастраненное использование событий это обработка данных в полях форм,
         или же ответ на событие клика мыши по кнопке и события click/change на полях форм.</p>

<pre>
  &lt;input id=&quot;myname&quot; type=&quot;text&quot;&gt;
  &lt;button id=&quot;button&quot;&gt;Say My Name&lt;/button&gt;
  
  &lt;script&gt;
var button = document.getElementById('button');
var onClick = function(event) {
    var myName = document.getElementById(&quot;myname&quot;).value;
    alert(&quot;Hi, &quot; + myName);
};
button.addEventListener('click', onClick);
  &lt;/script&gt;
</pre>

     </section>
    </div>
    
   
    <div class="slide normal"> 
     <h1 class="center"><a target="_blank" href="exercises/events.html">Практика!</a></h2>
    </div>
    
    
    
    <div class="slide normal"> 
     <header><h2>Объект window</h2></header>
     <section class="content"> 
     <p>Когда вы выполняете JS в браузере, это давет вам возможность использовать объект <code><a target="_blank" href="https://developer.mozilla.org/en/DOM/window">window</a></code> с его полезными методами и свойвами:</p>

<pre>
window.location.href;

window.navigator.userAgent;

window.scrollTo(10, 50);

window.alert("Hello world!");
</pre>

<p>Объект <code>window</code> глобальный, а значит все его свойства доступны и методы доступны глобально:
</p>
<pre class="prettyprint">
window.alert("Hi!");
</pre>
<p>...тоже самое что и:</p>
<pre class="prettyprint">
alert("Hi");
</pre>
     </section>
    </div>
  
   
    
    
    
    <div class="slide normal"> 
     <header><h2>Анимация в JS</h2></header>
     <section class="content"> 
     <p>Старый и простой путь анимации в JS это использовать эти два метода <code>window</code>.</p>

<p>Вызвать функцию один раз после задержки:</p>
<pre class="prettyprint">
window.setTimeout(callbackFunction, delayMilliseconds);
</pre>
<p>Вызывать функцию повторно время от времени, с указанным интервалом между вызовами:</p>
<pre class="prettyprint">
window.setInterval(callbackFunction, delayMilliseconds);
</pre>

<p>Например, анимация с использованием атрибутов элемента DOM:</p>
<pre class="prettyprint">
var makeImageBigger = function() {
  var img = document.getElementsByTagName('img')[0];
  img.setAttribute('width', img.width+10);
};
window.setInterval(makeImageBigger, 1000);
</pre>

     </section>
    </div>




    <div class="slide normal">
     <header><h2>Анимация стилей</h2></header>
     <section class="content"> 
     <p>Анимация размеров, прозрачности, позиции и цвета:</p>

<pre>
var img = document.getElementsByTagName('img')[0];
img.style.opacity = 1.0;
window.setInterval(fadeAway, 1000);
var fadeAway = function() {
  img.style.opacity = img.style.opacity - .1;
};
</pre>

<pre class="prettyprint">
var img = document.getElementsByTagName('img')[0];
img.style.position = 'absolute';
img.style.top = '0px';
var watchKittyFall = function() {
  var oldTop = parseInt(img.style.top, 10);
  var newTop = oldTop + 10;
  img.style.top = newTop + 'px';
};
window.setInterval(watchKittyFall, 1000);
</pre>
<p style="font-size:small">Важно: вы должны указывать единицы измерения при присваивании и убирать их при вычислениях.</p>
     </section>
    </div>
    
   
    
    
    
    <div class="slide normal"> 
     <header><h2>Оставновка анимации основанной на таймаутах</h2></header>
     <section class="content"> 
     <p>Для остановка анимации в конкретной точке, сохраните идентификатор таймера в переменной и очистите таймер с помощью этих методов:</p>

<pre>
window.clearTimeout(timer);
window.clearInterval(timer);
</pre>

<pre class="prettyprint">
var img = document.getElementsByTagName('img')[0];
img.style.opacity = 1.0;

var fadeAway = function() {  
  img.style.opacity = img.style.opacity - .1;
  if (img.style.opacity &lt; .5) {
    window.clearInterval(fadeTimer);
  }
};
var fadeTimer = window.setInterval(fadeAway, 100);
</pre>

     </section>
    </div>

       <div class="slide normal">
           <header><h2>Анимация в JS - requestAnimationFrame</h2></header>
           <section class="content">
               <p>Современное и более эфективное решение это метод <code>requestAnimationFrame</code>.</p>

               <p>Такой вызов планирует запуск callback в ближайшее время, когда браузер сочтёт возможным осуществить анимацию.:</p>
               <pre class="prettyprint">
var requestId = requestAnimationFrame(callback);
</pre>
               <p>Отменить запланированное выше выполнение callback:</p>
               <pre class="prettyprint">
cancelAnimationFrame(requestId);
</pre>

           </section>
       </div>

       <div class="slide normal">
           <header><h2>Анимация в JS - requestAnimationFrame</h2></header>
           <section class="content">
               <p>Функция анимации на основе requestAnimationFrame:</p>
               <pre class="prettyprint">
// Рисует функция draw
// Продолжительность анимации duration
function animate(draw, duration) {
  var start = performance.now();
  requestAnimationFrame(function animate(time) {
    // определить, сколько прошло времени с начала анимации
    var timePassed = time - start;
    // возможно небольшое превышение времени, в этом случае зафиксировать конец
    if (timePassed > duration) timePassed = duration;
    // нарисовать состояние анимации в момент timePassed
    draw(timePassed);
    // если время анимации не закончилось - запланировать ещё кадр
    if (timePassed < duration) {
      requestAnimationFrame(animate);
    }
  });
}
</pre>
           </section>
       </div>


       <div class="slide normal">
           <header><h2>Анимация в JS - requestAnimationFrame</h2></header>
           <section class="content">
               <p>Анимация прозрачности через функцию animate.</p>
               <pre class="prettyprint">
var img = document.getElementsByTagName('img')[0];
img.style.opacity = 1.0;

var duration = 2000;
animate(function(timePassed) {
  img.style.opacity = 1 - Math.round(timePassed/200)/10;
}, duration);
</pre>
           </section>
       </div>


       <div class="slide normal">
     <h1 class="center"><a target="_blank" href="exercises/animation.html">Практика!</a></h2>
    </div>

    
    <div class="slide normal">
     <header><h2>Читать на эту тему</h2></header>
     <section class="content"> 
     <ul>
 <li><a href="https://learn.javascript.ru/js-animation">JS-Анимация</a>
 <li><a href="https://learn.javascript.ru/css-transitions">CSS-анимации</a>
 <li><a href="https://learn.javascript.ru/bezier">Кривые Безье</a>
</ul>
     </section>
    </div>


   </div>

 </body>
</html>
