
<!doctype html>
<html>
  <head>
    <title>AJAX</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="../common/normalize.css" />
    <link rel="stylesheet" type="text/css" href="../common/presentation.css" />
    <link rel="stylesheet" type="text/css" href="../common/prettify.css" />
    <link  href="http://fonts.googleapis.com/css?family=Ubuntu:300,300italic,regular,italic,500,500italic,bold,bolditalic" rel="stylesheet" type="text/css">
    <script src="../common/jquery.js" type="text/javascript"></script>
    <script src="../common/fathom.js"></script>
    <script src="../common/prettify.js"></script>
    <script>
      $(document).ready(function (){
        $('pre').addClass('prettyprint').attr('tabIndex', 0);
        prettyPrint();

        $('#presentation').fathom({
          onActivateSlide: function () {
            var $slide = $(this);
            $slide.find('pre:first').focus();
          }
        });
        $('body').keypress(function(event){
           if (event.which === 110) {
             $('.speaker-notes').toggle();
           }
        });
      });
    </script>
  </head>
  <body>
    <div id="presentation">
      <div id="presentation-counter"></div>
      <div id="slides">

      <div class="slide normal">
        <h2 class="center">Асинхронные технологии: AJAX/JSON</h2>
        <pre class="speaker-notes" style="display:none">Заметка:
            Мы не используем API на этом занятии, мы только рассматриваем концепт AJAX.</pre>
      </div>

      <div class="slide normal">
        <header><h2 class="center">Обзор: HTML + JS, вместе!</h2></header>
        <section class="content"></section>
<pre class="speaker-notes" style="display:none">Классический управляемые данными веб-приложение, написана так, что:
отображает веб-страницы
ожидает действий пользователя
запрашивает данные с сервера
перезагружает страницу

Это приводит к тому, что пользователь может ощутить "время простоя" - это период времени, когда пользователь не может взаимодействовать с веб-страницей.</pre>
      </div>

      <div class="slide normal">
        <header><h2>Статичный контент + <a href="https://htmlacademy.ru/demos/1#step1">Прогрессивное улучшение(Progressive Enhancement)</a></h2></header>
        <section class="content" style="text-align:center">
          <br>
          <img src="img/static_content_prog_enhance.png" width="">
          <br>
          <a href="http://www.teaching-materials.org/jquery2/exercises/exercise_events_solution.html">Пример</a>

        </section>
<pre class="speaker-notes" style="display:none">The classic data-driven web app is written so that it:
displays a webpage
waits for user interaction
queries the server for data
reloads the webpage
This has the effect that the user has "down time" - there is a period of time where they can't interact with the webpage at all.</pre>
      </div><!--/static content + prog enhancement-->

      <div class="slide normal">
        <header><h2>Динамический контент</h2></header>
        <section style="text-align:center" class="content">
          <br>
          <br>
          <img src="img/dynamic_content.png">
        </section>
<pre class="speaker-notes" style="display:none">The classic data-driven web app is written so that it:
displays a webpage
waits for user interaction
queries the server for data
reloads the webpage
This has the effect that the user has "down time" - there is a period of time where they can't interact with the webpage at all.</pre>
      </div><!--/dynamic content-->

      <div class="slide normal">
        <header><h2>Сохранение данных в JSON</h2></header>
        <section class="content">
          <ul>
            <li>Пары ключ/значение(key/value)</li>
            <li>Ключ должен быть в двойных кавычках (в отличии от JS объектов)</li>
            <li>Значение может быть следующих типов данных: Number, String, Boolean, Array, Object, <code>null</code></li>
            <li>Напоминает объекты/хеши, таблицы/структы из других языков программировния</li>
            <li>Валидация @ <a href="http://jsonlint.com">JSONLint.com</a></li>
          </ul>
<pre>
{
 "firstName": "Jane", 
 "lastName": "Smith", 
 "address": { 
   "streetAddress": "425 2nd Street",
 }, 
 "phoneNumbers": [ 
   "212 732-1234" ]
} 
</pre>
        </section>
      </div><!--/storing data in JS: JSON-->

      <div class="slide normal">
        <header><h2>Используем JS для преобразования JSON в DOM</h2></header>
        <section class="content">
<pre>
var myProfileJSON = '{"firstName": "Liz", "lastName": "Howard", "cats": ["Tribbles", "Jean Claws"]}';
var myProfile = JSON.parse(myProfileJSON);
var p = document.createElement('p');
p.innerHTML = 'My name is ' + myProfile.firstName + ' ' + myProfile.lastName + '. ';
p.innerHTML += 'My cats are ' + myProfile.cats.join(', ') + '.';


var p = $('&lt;p&gt;');
p.html('My name is ' + myProfile.firstName + ' ' + myProfile.lastName + '. ');
p.append('My cats are ' + myProfile.cats.join(', ') + '.');
</pre>
        </section>
      </div>

      <div class="slide normal">
        <header><h2 align="center"><a href="exercise_json.html">практика</a></h2></header>
        <section class="content">
          <p align="center">Объединитесь с человеком, который сидит рядом для совместной работы.</p>
        </section>
      </div><!--exercises-->

      <div class="slide normal">
        <header><h2>AJAX</h2></header>
        <section class="content">
          <p align="center">Асинхронный JavaScript и "XML"<p>
          <p align="center"><img src="img/ajax.png"></p>
<pre class="speaker-notes" style="display:none">Allows for asynchronous data transfer between a webpage &amp; web server.

Javascript tells the browser to retrieve a particular URL and send the data back to the webpage.</pre>
        </section>
      </div><!--AJAX-->


      <div class="slide normal">
        <header><h2>AJAX в реальныз условиях</h2></header>
        <section class="content">
          <p align="center"><a href="https://www.airbnb.com/wishlists/popular" target="_blank"><img src="img/airbnb.png"></a></p>

<pre class="speaker-notes" style="display:none">Allows for asynchronous data transfer between a webpage &amp; web server.

Javascript tells the browser to retrieve a particular URL and send the data back to the webpage.</pre>
        </section>
      </div><!--ajax in the wild-->

      <div class="slide normal">
        <header><h2>Web 1.0 и действия пользователя</h2></header>
        <section class="content">
          <br>
          <p align="center"><img src="img/web_user_int1.png"></p>
<pre class="speaker-notes" style="display:none">The classic data-driven web app is written so that it:
displays a webpage
waits for user interaction
queries the server for data
reloads the webpage
This has the effect that the user has "down time" - there is a period of time where they can't interact with the webpage at all.</pre>
        </section>
      </div><!--web 1.0 and UI-->

      <div class="slide normal">
        <header><h2>Web 2.0 и действия пользователя</h2></header>
        <section class="content">
          <br>
          <p align="center"><img src="img/web_user_int2.png"></p>
<pre class="speaker-notes" style="display:none">The new data-driven web app is written so that it:
displays a webpage
waits for user interaction
queries the server for data
reloads part of the webpage

The user can still interact with other parts of the page while one part is loading and they can selectively load the content they're interested in.

This may seem like a subtle difference, but it's arguably the most important part of Web2.0 programming.</pre>
        </section>
      </div><!--web 2.0 and UI-->

      <div class="slide normal">
        <header><h2>Web 1.0 в сравнении с Web 2.0</h2></header>
        <section class="content">
          <br>
          <table>
            <tr>
              <td><img src="img/web_user_int1.png" width="75%"></td>
              <td><img src="img/web_user_int2.png" width="75%"></td>
            </tr>
            <tr>
              <td>Использованные технологии:</td>
              <td>Использованные технологии:</td>
            </tr>
            <tr>
              <td style="vertical-align:top">
                <ul>
                  <li>HTML</li>
                  <li>Server-Side</li>
                </ul>
              </td>
              <td style="vertical-align:top">
                <ul>
                  <li>HTML</li>
                  <li>Server-Side</li>
                  <li>AJAX</li>
                </ul>
              </td>
            </tr>
          </table>
        </section>
      </div><!--web 1.0 versus web 2.0-->

      <div class="slide normal">
        <header><h2>Запрос и ответ</h2></header>
        <section class="content">
          <p align="center"><img src="http://abhijitjana.files.wordpress.com/2010/10/2.jpg"/></p>
          <ul>
            <li><strong>Front-End: </strong>Эй, Back! Вот мой паспорт. Могу ли получить некоторые данные? Как на счет книг через AJAX?</li>
            <li><strong>Back-End </strong><em>дай подумать, как обработать твой запрос...</em></li>
            <li><strong>Back-End </strong><em>посмотрю в базе данных, поиск...</em></li>
            <li><strong>Back-End: </strong>200 OK, вот некоторые книги через AJAX!</li>
            <li><strong>Front-End: </strong>Спасибо! Я планирую сделать онлайн книжную полку с этимим данными!</li>
        </section>
      </div><!--Requests and Responses-->

      <div class="slide normal">
        <header><h2>Анатомия XMLHttpRequest</h2></header>
        <section class="content">
<pre>
// инициализация запроса
var request = new XMLHttpRequest(); 

// добавить слушателя события
request.addEventListener('load', function () {

  // преобразование строки в объект
  console.log(JSON.parse(request.responseText));
});

request.open('get', '/path/to/api', true);
request.setRequestHeader('Content-type', 'application/json');
request.send();
</pre>
        </section>
      </div><!--Anatomy of an XMLHttpRequest-->

      <div class="slide normal">
        <header><h2>XMLHttpRequest: Идем дальше</h2></header>
        <section class="content">
          <ul>
            <li>Старые IE реализовывал XMLHR не так как другие браузеры, поэтому возможно там следует использовать ActiveXObject если XMLHttpRequest не доступен.</li>
            <li>Различные CRUD операции могут быть использованы</li>
            <li>Иногда понадобиться отправлять дополнительные данные серверу</li>
            <li>Ошибки и ответы нужно обрабатывать</li>
          </ul>
            <a href="https://learn.javascript.ru/ajax-xmlhttprequest">Информция о XMLHttpRequest</a>
        </section>
      </div>

      <div class="slide normal">
          <header><h2>Метод fetch - замена XMLHttpRequest</h2></header>
          <section class="content">
              <pre>
fetch('/article/fetch/user.json')
  .then(function(response) {
    alert(response.headers.get('Content-Type')); // application/json; charset=utf-8
    alert(response.status); // 200

    return response.json();
   })
  .then(function(user) {
    alert(user.name);
  })
  .catch( alert );
              </pre>
              <a href="https://learn.javascript.ru/fetch">Информция о fetch</a>
          </section>
      </div>

      <div class="slide normal">
        <header><h2>Отладка AJAX запросов</h2></header>
        <section class="content">
          <ul>
            <li>Выбираем табы NET/Network в панели разработчика (Dev Tools) Chrome или Firebug,
                выбирите "XHR" фильтр чтобы увидеть все созданные XMLHttpRequests.</li>
            <li>Посмотрите что в запросе и ответе нажав на один из списка.</li>
          </ul>
          <p align="center"><img src="img/debug_ajax.png"></p>
        </section>
      </div><!--debugging ajax requests-->

      <div class="slide normal">
        <header><h2>Посмотрите запросы на этой странице.</h2></header>
        <section class="content">
          <p align="center"><a href="https://www.airbnb.com/wishlists/popular" target="_blank"><img src="img/airbnb.png"></a></p>
            <p>Попробуйте перейти по ссылкам или нажать на кнопки</p>
        </section>
      </div><!--air bnb site-->

      <div class="slide normal">
        <header><h2>Кросдоменная политика (Cross Domain Policy)</h2></header>
        <section class="content">
          <br>
          <p align="center">For http://store.company.com/dir/page.html:</p>
          <br>
          <p align="center"><img src="img/cross_domain_policy.png"></p>
        </section>
      </div><!--cross domain policy-->

    </div><!--/slides-->
  </div><!--/presentation-->
</body>
