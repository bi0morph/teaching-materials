
<!doctype html>
<html>
  <head>
    <title>AJAX</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="../common/normalize.css" />
    <link rel="stylesheet" type="text/css" href="../common/presentation.css" />
    <link rel="stylesheet" type="text/css" href="../common/prettify.css" />
    <link  href="http://fonts.googleapis.com/css?family=Ubuntu:300,300italic,regular,italic,500,500italic,bold,bolditalic" rel="stylesheet" type="text/css">
    <script src="../common/jquery.js" type="text/javascript"></script>
    <script src="../common/fathom.js"></script>
    <script src="../common/prettify.js"></script>
    <script>
      $(document).ready(function (){
        $('pre').addClass('prettyprint').attr('tabIndex', 0);
        prettyPrint();

        $('#presentation').fathom({
          onActivateSlide: function () {
            var $slide = $(this);
            $slide.find('pre:first').focus();
          }
        });
        $('body').keypress(function(event){
           if (event.which === 110) {
             $('.speaker-notes').toggle();
           }
        });
      });
    </script>
  </head>
  <body>
    <div id="presentation">
      <div id="presentation-counter"></div>
      <div id="slides">

      <div class="slide normal">
        <h2 class="center">Асинхронные технологии: AJAX/JSON</h2>
        <pre class="speaker-notes" style="display:none">Заметка:
            Мы не используем API на этом занятии, мы только рассматриваем концепт AJAX.</pre>
      </div>

      <div class="slide normal">
        <header><h2 class="center">Обзор: HTML + JS, вместе!</h2></header>
        <section class="content"></section>
<pre class="speaker-notes" style="display:none">Классический управляемые данными веб-приложение, написана так, что:
отображает веб-страницы
ожидает действий пользователя
запрашивает данные с сервера
перезагружает страницу

Это приводит к тому, что пользователь может ощутить "время простоя" - это период времени, когда пользователь не может взаимодействовать с веб-страницей.</pre>
      </div>

      <div class="slide normal">
        <header><h2>Статичный контент + <a href="https://htmlacademy.ru/demos/1#step1">Прогрессивное улучшение(Progressive Enhancement)</a></h2></header>
        <section class="content" style="text-align:center">
          <br>
          <img src="img/static_content_prog_enhance.png" width="">
          <br>
          <a href="http://www.teaching-materials.org/jquery2/exercises/exercise_events_solution.html">Пример</a>

        </section>
<pre class="speaker-notes" style="display:none">The classic data-driven web app is written so that it:
displays a webpage
waits for user interaction
queries the server for data
reloads the webpage
This has the effect that the user has "down time" - there is a period of time where they can't interact with the webpage at all.</pre>
      </div><!--/static content + prog enhancement-->

      <div class="slide normal">
        <header><h2>Динамический контент</h2></header>
        <section style="text-align:center" class="content">
          <br>
          <br>
          <img src="img/dynamic_content.png">
        </section>
<pre class="speaker-notes" style="display:none">The classic data-driven web app is written so that it:
displays a webpage
waits for user interaction
queries the server for data
reloads the webpage
This has the effect that the user has "down time" - there is a period of time where they can't interact with the webpage at all.</pre>
      </div><!--/dynamic content-->

      <div class="slide normal">
        <header><h2>Сохранение данных в JSON</h2></header>
        <section class="content">
          <ul>
            <li>Пары ключ/значение(key/value)</li>
            <li>Ключ должен быть в двойных кавычках (в отличии от JS объектов)</li>
            <li>Значение может быть следующих типов данных: Number, String, Boolean, Array, Object, <code>null</code></li>
            <li>Напоминает объекты/хеши, таблицы/структы из других языков программировния</li>
            <li>Валидация @ <a href="http://jsonlint.com">JSONLint.com</a></li>
          </ul>
<pre>
{
 "firstName": "Jane", 
 "lastName": "Smith", 
 "address": { 
   "streetAddress": "425 2nd Street",
 }, 
 "phoneNumbers": [ 
   "212 732-1234" ]
} 
</pre>
        </section>
      </div><!--/storing data in JS: JSON-->

      <div class="slide normal">
        <header><h2>Используем JS для преобразования JSON в DOM</h2></header>
        <section class="content">
<pre>
var myProfile = 
 {"firstName": "Liz", 
  "lastName": "Howard",
  "cats": ["Tribbles", "Jean Claws"]};

var p = document.createElement('p');
p.innerHTML = 'My name is ' + myProfile.firstName + ' ' + myProfile.lastName + '. ';
p.innerHTML += 'My cats are ' + myProfile.cats.join(', ') + '.';


var p = $('&lt;p&gt;');
p.html('My name is ' + myProfile.firstName + ' ' + myProfile.lastName + '. ');
p.append('My cats are ' + myProfile.cats.join(', ') + '.');
</pre>
        </section>
      </div>

      <div class="slide normal">
        <header><h2 align="center"><a href="exercise_json.html">практика</a></h2></header>
        <section class="content">
          <p align="center">Объединитесь с человеком, который сидит рядом для совместной работы.</p>
        </section>
      </div><!--exercises-->

      <div class="slide normal">
        <header><h2>AJAX</h2></header>
        <section class="content">
          <p align="center">= Asynchronous JavaScript and "XML"<p>
          <p align="center"><img src="img/ajax.png"></p>
<pre class="speaker-notes" style="display:none">Allows for asynchronous data transfer between a webpage &amp; web server.

Javascript tells the browser to retrieve a particular URL and send the data back to the webpage.</pre>
        </section>
      </div><!--AJAX-->


      <div class="slide normal">
        <header><h2>AJAX in the Wild</h2></header>
        <section class="content">
          <p align="center"><a href="https://www.airbnb.com/wishlists/popular" target="_blank"><img src="img/airbnb.png"></a></p>
          <p align="center">What else?</p>
<pre class="speaker-notes" style="display:none">Allows for asynchronous data transfer between a webpage &amp; web server.

Javascript tells the browser to retrieve a particular URL and send the data back to the webpage.</pre>
        </section>
      </div><!--ajax in the wild-->

      <div class="slide normal">
        <header><h2>Web 1.0 &amp; User Interaction</h2></header>
        <section class="content">
          <br>
          <p align="center"><img src="img/web_user_int1.png"></p>
<pre class="speaker-notes" style="display:none">The classic data-driven web app is written so that it:
displays a webpage
waits for user interaction
queries the server for data
reloads the webpage
This has the effect that the user has "down time" - there is a period of time where they can't interact with the webpage at all.</pre>
        </section>
      </div><!--web 1.0 and UI-->

      <div class="slide normal">
        <header><h2>Web 2.0 &amp; User Interaction</h2></header>
        <section class="content">
          <br>
          <p align="center"><img src="img/web_user_int2.png"></p>
<pre class="speaker-notes" style="display:none">The new data-driven web app is written so that it:
displays a webpage
waits for user interaction
queries the server for data
reloads part of the webpage

The user can still interact with other parts of the page while one part is loading and they can selectively load the content they're interested in.

This may seem like a subtle difference, but it's arguably the most important part of Web2.0 programming.</pre>
        </section>
      </div><!--web 2.0 and UI-->

      <div class="slide normal">
        <header><h2>Web 1.0 vs.Web 2.0</h2></header>
        <section class="content">
          <br>
          <table>
            <tr>
              <td><img src="img/web_user_int1.png" width="75%"></td>
              <td><img src="img/web_user_int2.png" width="75%"></td>
            </tr>
            <tr>
              <td>Technologies Used:</td>
              <td>Technologies Used:</td>
            </tr>
            <tr>
              <td style="vertical-align:top">
                <ul>
                  <li>HTML</li>
                  <li>Server-Side Scripts</li>
                </ul>
              </td>
              <td style="vertical-align:top">
                <ul>
                  <li>HTML</li>
                  <li>Server-Side Scripts</li>
                  <li>
                    AJAX
                  </li>
                </ul>
              </td>
            </tr>
          </table>
        </section>
      </div><!--web 1.0 versus web 2.0-->

      <div class="slide normal">
        <header><h2>Requests and Responses</h2></header>
        <section class="content">
          <p align="center"><img src="http://abhijitjana.files.wordpress.com/2010/10/2.jpg"/></p>
          <ul>
            <li><strong>Front-End: </strong>Hey, Back-End! Here's my credentials. Can I get some data? How about books on AJAX?</li>
            <li><strong>Back-End </strong><em>thinks about it, decides how to handle request...</em></li>
            <li><strong>Back-End </strong><em>looks in database, searches...</em></li>
            <li><strong>Back-End: </strong>200 OK, here are some books on AJAX!</li>
            <li><strong>Front-End: </strong>Thanks! I'm going to make an online bookshelf with the data!</li>
        </section>
      </div><!--Requests and Responses-->

      <div class="slide normal">
        <header><h2>Anatomy of an XMLHttpRequest</h2></header>
        <section class="content">
<pre>
// instantiate a new request
var request = new XMLHttpRequest(); 

// add event listeners
request.addEventListener('load', function () {

  // transform a string into a usable object
  console.log(JSON.parse(request.responseText));
});

request.open('get', '/path/to/api', true);
request.setRequestHeader('Content-type', 'application/json');
request.send();
</pre>
        </section>
      </div><!--Anatomy of an XMLHttpRequest-->

      <div class="slide normal">
        <header><h2>XMLHttpRequest: Diving Deeper</h2></header>
        <section class="content">
          <ul>
            <li>IE implemented XMLHR differently than the other browsers, so you must use the ActiveXObject if XMLHttpRequest is not available.</li>
            <li>Different CRUD methods may be used</li>
            <li>Sometimes you will need to send additional data</li>
            <li>Errors and responses need to be handled</li>
          </ul>
        </section>
      </div>

      <div class="slide normal">
        <header><h2 class="center">But we don't usually write all that code...</h2></header>
        <section class="content"></section>
      </div><!--we don't write all that code-->

      <div class="slide normal">
        <header><h2>jQuery + AJAX</h2></header>
        <section class="content">
          <p>Use the jQuery $.<a href="http://api.jquery.com/jQuery.ajax/">ajax</a> function.</p>
<pre>
$.ajax({type: "GET",
  url: "filename.json",
  dataType: "json",
  success: function(data) { },
  error: function(xhr, status, e) { }
});
</pre>
        </section>
      </div><!--jquery and ajax-->

      <div class="slide normal">
        <header><h2>Using jQuery for everything</h2></header>
        <section class="content">
<pre>
$.ajax({type: "GET",
  url: "books.json",
  dataType: "json",
  success: function(books) { 
    for (var i = 0; i < books.length; i++) { 
      var book = books[i];
      var p = $('&lt;p&gt;');
      p.html(book.title + ' by ' + book.author);
      $('body').append(p);
    }
  },
  error: function(xhr, status, e) {
    console.log(status, e);
  }
});
</pre>
<pre class="speaker-notes" style="display:none">Don't forget that jQuery is just a library, written by human beings. Use it because it saves you time, but don't rely too hard on it!</pre>
        </section>
      </div><!--using jquery for everything-->

      <div class="slide normal">
        <header><h2>Debugging AJAX Requests</h2></header>
        <section class="content">
          <ul>
            <li>Click the NET/Network tab in Chrome Dev Tools or Firebug, select "XHR" filter to see all XMLHttpRequests made.</li>
            <li>See what the request responded with by clicking its "Response" tab.</li>
          </ul>
          <p align="center"><img src="img/debug_ajax.png"></p>
        </section>
      </div><!--debugging ajax requests-->

      <div class="slide normal">
        <header><h2>Exploring this will keep you busy for hours.</h2></header>
        <section class="content">
          <p align="center"><a href="https://www.airbnb.com/wishlists/popular" target="_blank"><img src="img/airbnb.png"></a></p>
<pre class="speaker-notes" style="display:none">Oh my god, explore this tab. It will teach you so much about what's in requests and responses. Google everything you don't understand. </pre>
        </section>
      </div><!--air bnb site-->

      <div class="slide normal">
        <header><h2 class="center"><a href="exercise_ajax.html">Exercise Time!</a></h2></header>
        <section class="content">
          <p align="center">Pair with the person(s) next to you to work through it together.</p>
          <p align="center"><img src="img/kitties2.png"></p>
        </section>
      </div><!--exercises-->

      <div class="slide normal">
        <header><h2>AJAX + Servers</h2></header>
        <section class="content">
<pre>
$.ajax({type: "GET",
  url: "/api/books",
  dataType: "json",
  data: {'sortBy': 'author'},
  success: processBooks
});
</pre>
<pre>
$.ajax({type: "POST",
  url: "/api/book/new",
  dataType: "json",
  data: {'title': 'I, Robot', 'author': 'I. Asimov'}
  success: processBoooks
});
</pre>
        </section>
      </div><!--ajax and servers-->

      <div class="slide normal">
        <header><h2>Cross Domain Policy</h2></header>
        <section class="content">
          <br>
          <p align="center">For http://store.company.com/dir/page.html:</p>
          <br>
          <p align="center"><img src="img/cross_domain_policy.png"></p>
        </section>
      </div><!--cross domain policy-->

      <div class="slide normal">
        <header><h2>AJAX Gotchas</h2></header>
        <section class="content">
          <ul>
            <li>Cross domain requests have restrictions</li>
            <li>Multiple AJAX requests don't return in order</li>
            <li>Hard to transfer files</li>
            <li>Can't transfer binary content</li>
            <li>Browsers can over-cache/under-cache requests</li>
          </ul>
          <p>
            UI No-Nos:
            <ul>
              <li>Not having linkable state</li>
              <li>Not letting users know that something is loading</li>
              <li>Breaking the back button</li>
              <li><a href="http://ajaxpatterns.org/Ajax_Gotchas">More here.</a></li>
            </ul>
          </p>
        </section>
      </div><!--ajax gotchas-->

      <div class="slide normal">
        <header><h2>List of additional key concepts</h2></header>
        <section class="content">
          <ul>
            <li>What are the parts of an HTTP request?</li>
            <li>What does CRUD stand for?</li>
            <li>What is the same origin policy?</li>
            <li>What are the 4 basic CRUD operations and methods?</li>
            <li>What is the difference between JSONP and JSON?</li>
          </ul>
        </section>
      </div><!--ajax gotchas-->

    </div><!--/slides-->
  </div><!--/presentation-->
</body>
